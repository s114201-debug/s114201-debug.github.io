<!DOCTYPE html>
height: 100,
grounded: false
};
}


// --- 貓咪物理更新 ---
function physicsLoop() {
const gravity = 0.4;
const floor = window.innerHeight - 20;


for (let c of catsOnScreen) {
// 加重力
if (!c.grounded) c.vy += gravity;


// 更新位置
c.x += c.vx;
c.y += c.vy;


// --- 地板碰撞 ---
if (c.y + c.height >= floor) {
c.y = floor - c.height;
c.vy *= -0.3; // 彈力
if (Math.abs(c.vy) < 0.5) {
c.vy = 0;
c.grounded = true;
}
}


// --- 與其他貓咪的碰撞 ---
for (let other of catsOnScreen) {
if (other === c) continue;


// AABB 碰撞檢查
if (
c.x < other.x + other.width &&
c.x + c.width > other.x &&
c.y < other.y + other.height &&
c.y + c.height > other.y
) {
// 水平分離
if (c.x < other.x) {
c.x -= 2;
other.x += 2;
} else {
c.x += 2;
other.x -= 2;
}


// 垂直堆疊
if (c.y < other.y) {
c.y = other.y - c.height;
c.vy = 0;
c.grounded = true;
}
}
}


// 更新 DOM
c.el.style.left = c.x + "px";
c.el.style.top = c.y + "px";
}


requestAnimationFrame(physicsLoop);
}


// 啟動物理循環
requestAnimationFrame(physicsLoop);


document.addEventListener("click", (e) => {
const randomCat = cats[Math.floor(Math.random() * cats.length)];
const newCat = createCatElement(e.clientX, e.clientY, randomCat);


document.body.appendChild(newCat.el);
catsOnScreen.push(newCat);
});
// 加入左右邊界反彈
cats.forEach(cat => {
// 左右牆反彈
if (cat.x - cat.size < 0) {
cat.x = cat.size;
cat.vx *= -0.7;
}
if (cat.x + cat.size > canvas.width) {
cat.x = canvas.width - cat.size;
cat.vx *= -0.7;
}
});


</script>


</body>
</html>
